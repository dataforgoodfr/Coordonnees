{
  "layers": {
    "satellite": {
      "type": "xyzservices",
      "provider": "Esri.WorldImagery"
    },
    "villages": {
      "type": "openmaptiles",
      "layer": "place",
      "filters": { "class": "village" }
    },
    "towns": {
      "type": "openmaptiles",
      "layer": "place",
      "filters": { "class": "town" }
    },
    "boundaries": {
      "type": "openmaptiles",
      "layer": "boundary",
      "filters": { "admin_level": 2 },
      "style": { "paint": { "line-color": "hsl(248,7%,66%)" } }
    },
    "placettes": {
      "type": "datapackage",
      "path": "../catalog/inventaire_id",
      "resource": "inventaire_id",
      "groupby": ["cod"],
      "aggregate": {
        "geometry": "centroid gps",
        "richness": "count unique ind.ess_arb",
        "dominant_height": "avg ind.haut where ind.haut > percentile(ind.haut, 80)"
      },
      "popup": {
        "trigger": "click",
        "html": "<h1>Placette {{ cod }}</h1>Richesse: {{ richness }}<br>Hauteur dominante: {{ dominant_height }}<br>Structure du sol: "
      }
    }
  },
  "controls": [
    {
      "type": "compass",
      "position": "top-left"
    },
    {
      "type": "layer",
      "position": "top-right"
    },
    {
      "type": "scale",
      "position": "bottom-left"
    }
  ]
}
